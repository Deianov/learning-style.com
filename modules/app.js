const IS_MOBILE=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),IS_DARK_MODE=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,IS_BROWSER="object"==typeof window&&"object"==typeof document,IS_HTTPS="https:"===location.protocol,APP_NAME="learning-style",APP_TITLE="Learning-Style",APP_IS_STATIC=!0,production=!1,APP_VERSION="18.12.2023",APP_LANG="en",APP_KEYBOARD={mode:IS_MOBILE?2:1,size:0},USER={};export default USER;let INFO_STRING=`state: development, version: ${APP_VERSION} (static), `;INFO_STRING+=IS_MOBILE?"mobile OS: ":"OS: ",INFO_STRING+=navigator.userAgent,INFO_STRING+=IS_DARK_MODE?", DarkMode":"",document.getElementsByClassName("version")[0].textContent=INFO_STRING;const CSS_COLORS=[{name:"white",colors:["white"]},{name:"black",colors:["black"]},{name:"dark",colors:["#373737"]},{name:"green",colors:["#28a745"]},{name:"red",colors:["#dc3545"]},{name:"orange",colors:["#ff6600"]},{name:"-",colors:[""]},{name:"gray-dark",colors:["#333333"]},{name:"gray",colors:["#646464"]},{name:"gray-light",colors:["#959595"]},{name:"gray-text",colors:["#cacaca"]},{name:"gray-line",colors:["#dedede"]},{name:"--",colors:[""]},{name:"light-red",colors:["#feaec8"]},{name:"light-blue",colors:["#99d9e9"]},{name:"light-yellow",colors:["#efe4b0"]},{name:"light-pink",colors:["#c7bfe6"]},{name:"---",colors:[""]},{name:"links",colors:["#0275d8"]},{name:"color-bg",colors:["#f1f1f1"]},{name:"color-bg-hover",colors:["#ddd"]},{name:"hover",colors:["#1795ec"]},{name:"active",colors:["#4299E1"]},{name:"border",colors:["#ccc"]},{name:"submit",colors:["#4caf50"]},{name:"submit-hover",colors:["#45a049"]},{name:"logo",colors:["#517cc6"]},{name:"----",colors:[""]},{name:"success",colors:["#c1ffde","#c1ffde","#dbfff8"]},{name:"danger",colors:["#ffcede"]},{name:"error",colors:["#e00"]},{name:"info",colors:["#4299E1"]},{name:"alert-success",colors:["#00A4A6"]}],PATH_LOCAL="http://192.168.0.52:3000",PATH_RELATIVE=".",PATH_URL=".",PATH_API="./api",PATH_JSON="./json",DOM_PAGEHEADER_TAGNAME="header",DOM_MENU_CLASSNAME="navbar",DOM_TOPICS_PARENT_TAGNAME="aside",DOM_ARTICLE_TAGNAME="article",DOM_HEADER_ID="header",DOM_CONTROL_ID="control",DOM_CONTENT_ID="content",DOM_MESSAGES_ID="messages",DOM_BOTTOM_ID="bottom",DOM_CDATE_ID="cdate",DOM_BREADCRUMB_CLASSNAME="breadcrumb",DOM_BREADCRUMB_TAGNAME="ul",DOM_SUBJECT_CLASSNAME="subject",DOM_NOTIFY_CLASSNAME="notify-box",CLASSNAME_FOCUS="focus",ASSETS_LOADER_PUFF='<img src="./assets/images/loaders/puff.svg" alt="loader" width="60" height="60"></img>',DEBUG_CONTENT='<svg id="kiwi" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" viewBox="0 65.326 612 502.174" enable-background="new 0 65.326 612 502.174" xml:space="preserve"><ellipse class="ground" cx="283.5" cy="487.5" rx="259" ry="80"/><path class="kiwi" d="M210.333,65.331C104.367,66.105-12.349,150.637,1.056,276.449c4.303,40.393,18.533,63.704,52.171,79.03 c36.307,16.544,57.022,54.556,50.406,112.954c-9.935,4.88-17.405,11.031-19.132,20.015c7.531-0.17,14.943-0.312,22.59,4.341 c20.333,12.375,31.296,27.363,42.979,51.72c1.714,3.572,8.192,2.849,8.312-3.078c0.17-8.467-1.856-17.454-5.226-26.933 c-2.955-8.313,3.059-7.985,6.917-6.106c6.399,3.115,16.334,9.43,30.39,13.098c5.392,1.407,5.995-3.877,5.224-6.991 c-1.864-7.522-11.009-10.862-24.519-19.229c-4.82-2.984-0.927-9.736,5.168-8.351l20.234,2.415c3.359,0.763,4.555-6.114,0.882-7.875 c-14.198-6.804-28.897-10.098-53.864-7.799c-11.617-29.265-29.811-61.617-15.674-81.681c12.639-17.938,31.216-20.74,39.147,43.489 c-5.002,3.107-11.215,5.031-11.332,13.024c7.201-2.845,11.207-1.399,14.791,0c17.912,6.998,35.462,21.826,52.982,37.309 c3.739,3.303,8.413-1.718,6.991-6.034c-2.138-6.494-8.053-10.659-14.791-20.016c-3.239-4.495,5.03-7.045,10.886-6.876 c13.849,0.396,22.886,8.268,35.177,11.218c4.483,1.076,9.741-1.964,6.917-6.917c-3.472-6.085-13.015-9.124-19.18-13.413 c-4.357-3.029-3.025-7.132,2.697-6.602c3.905,0.361,8.478,2.271,13.908,1.767c9.946-0.925,7.717-7.169-0.883-9.566 c-19.036-5.304-39.891-6.311-61.665-5.225c-43.837-8.358-31.554-84.887,0-90.363c29.571-5.132,62.966-13.339,99.928-32.156 c32.668-5.429,64.835-12.446,92.939-33.85c48.106-14.469,111.903,16.113,204.241,149.695c3.926,5.681,15.819,9.94,9.524-6.351 c-15.893-41.125-68.176-93.328-92.13-132.085c-24.581-39.774-14.34-61.243-39.957-91.247 c-21.326-24.978-47.502-25.803-77.339-17.365c-23.461,6.634-39.234-7.117-52.98-31.273C318.42,87.525,265.838,64.927,210.333,65.331 z M445.731,203.01c6.12,0,11.112,4.919,11.112,11.038c0,6.119-4.994,11.111-11.112,11.111s-11.038-4.994-11.038-11.111 C434.693,207.929,439.613,203.01,445.731,203.01z"/></svg>',QUIZ_CORRECT_QUESTION_SVG='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="10" height="10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" shape-rendering="geometricPrecision"><path d="M20 6L9 17l-5-5"/></svg>';
class ScopeCounter{min;max;stack;numbers;waitings;counts;DEFAULT_WAITING;shuffle;state;constructor(t,s,i){this.min=t,this.max=s,this.stack=[],this.numbers=[],this.waitings=[],this.counts=[],this.DEFAULT_WAITING=5,this.shuffle=i,this.state={}}getValue(){return this.isNumber(this.state.value)?this.state.value:this.stack.slice(-1)[0]}next(){if(this.isEmpty()&&this.reset(),this.hasNext()){if(this.isWaiting())return this.state.value=this.waitings.shift(),this;this.stack.push(this.numbers.splice(this.shuffle?this.randomIndex():0,1)[0])}return this.resetState(),this}previous(){if(this.hasPrevious()){const t=this.getValue();this.stack.length>1&&!this.isNumber(this.state.value)&&(this.stack.pop(),this.numbers.unshift(t)),this.removeFromWaiting(t),this.removeFromWaiting(this.stack.slice(-1)[0])}return this.resetState(),this}removeFromWaiting(t){if(this.waitings.length){const s=this.waitings.indexOf(t);s>-1&&(this.waitings.splice(s,1),this.counts.splice(s,1))}}repeat(t){if(this.hasPrevious()){const s=this.getValue();this.waitings.includes(s)?this.counts[this.waitings.indexOf(s)]=t||this.DEFAULT_WAITING:(this.waitings.push(s),this.counts.push(t||this.DEFAULT_WAITING))}return this.state.repeat=!0,this}getPreviousCount(){return this.stack.length-this.waitings.length}isWaiting(){return!!this.waitings.length&&(this.counts[0]--,(this.counts[0]<1||!this.numbers.length)&&(this.counts.shift(),!0))}skip(){return this.state.repeat&&this.removeFromWaiting(this.waitings.slice(-1)[0]),this.next()}randomIndex(){return Math.floor(Math.random()*this.numbers.length)}hasNext(){return this.numbers.length||this.waitings.length}hasPrevious(){return this.stack.length}isNumber(t){return"number"==typeof t}isValid(){return this.isNumber(this.max)&&this.min>-1&&this.max>this.min}isEmpty(){return!this.numbers.length&&!this.waitings.length&&!this.stack.length}isDone(){return!this.numbers.length&&!this.waitings.length&&this.stack.length}resetState(){for(const t in this.state)this.state[t]=void 0}resetRange(t,s){this.min=t,this.max=s,this.reset}reset(){if(this.stack.length=0,this.numbers.length=0,this.waitings.length=0,this.counts.length=0,this.resetState(),this.isValid()){let t=this.min;for(let s=this.min;s<this.max;s++)this.numbers[t++]=s}}toggleShuffle(){return this.reset(),this.shuffle=!this.shuffle,this.shuffle}getResults(){return{stack:this.stack.length,numbers:this.numbers.length,waitings:this.waitings.length,counts:this.counts.length}}}function SimpleCounter(t=0){const s=t;let i=t;return{value:()=>i,next:()=>++i,back:()=>(i=i>s?i-1:s,i),reset(){i=s}}}
async function sleep(e){const n=Date.now();let l=null;do{l=Date.now()}while(l-n<e);console.debug(`sleep: ${e}`)}
const dom={get:e=>"string"==typeof e?document.getElementById(e):document.body.contains(e)?e:null,getOrCreateElement(e,t,n){const o=e.getElementsByClassName(n),s=o.length>0?o[0]:null;return s&&0===t.localeCompare(s.tagName,"en",{sensitivity:"base"})?s:this.element(t,e)},getById(e){const t=document.getElementById(e);if(t)return t;throw new Error("Not found dom element with id: "+e)},getByTagName(e){const t=document.getElementsByTagName(e),n=t.length>0?t[0]:null;if(n)return n;throw new Error("Not found dom element with TagName: "+e)},getByClassName(e){const t=document.getElementsByClassName(e),n=t.length>0?t[0]:null;if(n)return n;throw new Error("Not found dom element with ClassName: "+e)},setOptions(e,t){if("string"!=typeof t){if("object"==typeof t)for(const[n,o]of Object.entries(t))"textContent"===n?e.textContent=o:"className"===n?e.className=o:e.setAttribute(n,o)}else{const n=t;e.setAttribute("class",n)}},element(e,t,n){const o=document.createElement(e);return t.appendChild(o),n&&this.setOptions(o,n),o},node(e,t){const n=document.createTextNode(e);return t.appendChild(n),n},text(e,t,n,o){const s=this.element(e,t);return s.textContent=n,o&&this.setOptions(s,o),s},removeAll(e){e&&(e.innerHTML="")},remove(e){if(e&&e.parentNode)return e.parentNode.removeChild(e)},svgUse(e,t,n,o,s,r="img"){const l="http://www.w3.org/2000/svg",m=document.createElementNS(l,"svg"),i=document.createElementNS(l,"use");return n&&m.setAttributeNS(null,"class",n),m.setAttributeNS(null,"width",o),m.setAttributeNS(null,"height",s||o),m.setAttributeNS(null,"role",r),i.setAttributeNS(null,"href",t),m.appendChild(i),e.appendChild(m),m}};
class Flags{static set(t,e){return t|e}static clear(t,e){return t&~e}static toggle(t,e){return t^e}static isTrue(t,e){return(t&e)>0}static isFalse(t,e){return 0==(t&e)}static toBits(t){return 1<<t}static toNumber(t){return t.reduce(((t,e,r)=>t+(e?1<<r:0)),0)}static toIndex(t){let e=0;return 0!=(4294901760&t)&&(t>>>=16,e=16),t>=256&&(t>>>=8,e+=8),t>=16&&(t>>>=4,e+=4),t>=4&&(t>>>=2,e+=2),e+(t>>>1)}static toArray(t,e){return Array.from({length:e},((e,r)=>Flags.isTrue(t,Flags.toBits(r))))}static byLength(t){let e=0;for(let r=0;r<t;r++)e|=1<<r;return e}}class ArrayOfFlags{number;_length;constructor(){this.number=0,this._length=0}get length(){return this._length}set length(t){this._length=t,this.number=Flags.byLength(t)}getIndex(t){return Flags.isTrue(this.number,Flags.toBits(t))}setIndex(t,e){this.number=e?Flags.set(this.number,Flags.toBits(t)):Flags.clear(this.number,Flags.toBits(t))}toggle(t){this.number=Flags.toggle(this.number,Flags.toBits(t))}get array(){return Flags.toArray(this.number,this.length)}set array(t){this._length=t.length,this.number=Flags.toNumber(t)}}
const numbers={getRandomInt:(t,e)=>(t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t)+t)),getRandomUUID:getRandomUUID,timer:()=>new Timer};function getRandomUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}var TimerOption;!function(t){t[t.hours=1]="hours",t[t.minutes=2]="minutes",t[t.seconds=4]="seconds",t[t.milliseconds=8]="milliseconds"}(TimerOption||(TimerOption={}));class Timer{static DEFAULT_OPTIONS=TimerOption.minutes+TimerOption.seconds;static DIGITS=2;static DIGITS_HUNDREDTHS=4;static USE_GROUPING=!1;startTime=0;endTime=0;flags=Timer.DEFAULT_OPTIONS;constructor(){}static formatNumber(t,e=1,i=!1){const r={minimumIntegerDigits:e,useGrouping:i};return new Intl.NumberFormat(void 0,r).format(t)}start(){this.startTime=(new Date).getTime(),this.endTime=this.startTime}stop(){this.endTime=(new Date).getTime()}setTime(t){return this.startTime=0,this.endTime=t,this}setOptions(...t){0===t.length?this.flags=Timer.DEFAULT_OPTIONS:this.flags=t.reduce(((t,e)=>t+e),0)}isTrue(t){return(this.flags&t)>0}result(...t){const e=this.flags,i=this.endTime-this.startTime;t.length>0&&this.setOptions(...t);const r=Timer.formatNumber(Math.floor(i/36e5),1),s=Timer.formatNumber(Math.floor(i%36e5/6e4),Timer.DIGITS),m=Timer.formatNumber(Math.floor(i%6e4/1e3),Timer.DIGITS),n=Timer.formatNumber(i%1e3,Timer.DIGITS_HUNDREDTHS,Timer.USE_GROUPING);let o="";return this.isTrue(TimerOption.hours)&&(o=r),this.isTrue(TimerOption.minutes)&&(o=(o?o+":":"")+s),this.isTrue(TimerOption.seconds)&&(o=(o?o+":":"")+m),this.isTrue(TimerOption.milliseconds)&&(o=(o?o+".":"")+n),this.flags=e,{time:i,label:o}}}class DateUtils{static DEFAULT_LOCALE="de-DE";static formatter=new Intl.DateTimeFormat(DateUtils.DEFAULT_LOCALE,{year:"numeric",month:"2-digit",day:"2-digit"});static getDateString(){return DateUtils.formatter.format(new Date)}}
const objects={isObject:s=>s&&"object"==typeof s&&!Array.isArray(s),isArray:s=>s&&Array.isArray(s),isError:s=>s instanceof Error,assign:object_assign};function object_assign(s,...r){let o,t;for(const c of r)for(const r of Object.keys(c||{}))o=c[r],t=s[r],objects.isObject(o)?(t||(s[r]={}),object_assign(s[r],o)):objects.isArray(o)?s[r]=o.slice():Object.assign(s,{[r]:o});return s}
const strings={isEmpty:e=>0===e.length,isBlank:e=>0===e.trim().length,isValid:e=>e.trim().length>0,clear:e=>e.trim().replace("  "," "),split(e){return this.clear(e).split(/([ .,:;_\-?!'`]+)/)},localeCompare:(e,t,r)=>0===e.localeCompare(t,"en",r||{sensitivity:"base"})};function toUTF8(e){const t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return(new TextDecoder).decode(r)}function toBase64(e){const t=encodeURIComponent(e);return btoa(t)}function removeHTML(e){return e.replace(/&/g,"").replace(/</g,"").replace(/"/g,"").replace(/'/g,"").replace(/`/g,"")}function maskMiddleChars(e,t){const r=strings.split(e.toLowerCase()),n=Array(r.length);let o,a,l=0;for(const e of r)a=e.length,o=a>3?e.charAt(0)+t.repeat(a-2)+e.slice(-1):3===a?e.charAt(0)+t.repeat(a-1):r.length>1?e:t.repeat(a),n[l++]=o;return n.join("")}
const url={getSearchString(r){const t=r.split("#")[0],[,a]=t.split("?");return a},getLocationSearchParams(){const r=new URLSearchParams(window.location.search),t={};for(const[a,e]of r)t[a]=e||null;return t},parseUrlSearchParams(r){const t=this.getSearchString(r),a=new URLSearchParams(t),e={};for(const[r,t]of a)e[r]=t||null;return e},toQuery:(r,t)=>"/?page="+r+(t?"&id="+t:"")};
const inMemoryRepository=function(){const t={};return{existsByName:e=>Object.prototype.hasOwnProperty.call(t,e),getByName:e=>t[e],save(e,s){return t[e]=s,this.getByName(e)},remove(e){this.existsByName(e)&&delete t[e]},reset(){for(const e of Object.keys(t))delete t[e]}}}(),cashingRepository={getByName:t=>inMemoryRepository.getByName(t),save:(t,e)=>inMemoryRepository.save(t,e),reset(){inMemoryRepository.reset()}},repository=function(){const t=PATH_JSON;async function e(e){const s=t+(e.startsWith("/")?"":"/")+e+".json",a=await fetch(s);if(!a.ok){const t="Failed to fetch data: "+a.statusText;return console.error(t),null}return await a.json()}return{async getByName(t){const s=e;return await s(t)}}}();class Data{async getJson(t,e,s){let a;return e&&(a=cashingRepository.getByName(t),a)?a:(a=await repository.getByName(t),a?s?(a=dataAdapter(a),a):(e&&(a=cashingRepository.save(t,a)),a):null)}removeCached(){cashingRepository.reset()}async getJsonWithPayload(t,e){const s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});return new Response(s,{status:200,statusText:"OK"})}}function dataAdapter(t){const e=t,s=Object.entries(e.props).filter((t=>t[0].startsWith("label"))).sort(((t,e)=>t[0].localeCompare(e[0]))).map((t=>t[1])),a={counts:Array(e.data.length).fill(0),status:!1,rows:e.data.length,row:0,tabs:Array(s.length).fill(!0),card:parseInt(e.props.card)};a.tabs[a.card]=!1;return{exercise:e.exercise,props:e.props,data:e.data,labels:s,state:a}}
const factory=function(){const n={};function t(t,e){const o=n[t]||{};o.instance=e,n[t]=o,o.event&&o.eventType&&e._addEvent(o.eventType,o.event)}return{addProps:function(t,e){const o=n[t]||{};Object.assign(o,e),n[t]=o},getInstance:async function(e){const o=e.name||e.constructor.name;let c=n[o]?.instance;return c||(c=new e,t(o,c)),c},getInstanceWithArgs:async function(e,...o){const c=e.name||e.constructor.name;let r=n[c]?.instance;return r||(r=new e(...o),t(c,r)),r},importClass:async function(n,t){const e=await import(n+encodeURIComponent(t));if("function"==typeof e.default)return e.default;throw new Error("Module does not export a default class constructor.")},importClassWithArgs:async function(n,t){const e=await import(n+encodeURIComponent(t));if("function"==typeof e.default)return e.default;throw new Error("Module does not export a default class constructor.")},importResource:async function(n,t){return(await import(n+encodeURIComponent(t))).default}}}();
class Cookie{constructor(){}static setItem(t,e,o){const{expires:s,path:i,domain:c,secure:r,suffix:n}=o||{},a=new Date(Date.now()+864e5*(s||365)).toUTCString();let m=t+"="+toBase64(e);m+="; expires="+a,"string"==typeof i&&(m+="; path="+i),"string"==typeof c&&(m+="; domain="+c),r&&(m+=";secure"),"string"==typeof n&&(m+=(";"===n.charAt(0)?"":"; ")+n),document.cookie=m}static getItem(t){const e=document.cookie.split(";").map((t=>t.trim()));for(const o of e){const[e,s]=o.split("=");if(e===t)return toUTF8(s)}return""}static delete(t){Cookie.setItem(t,"",{expires:-1})}}const localRepository=function(){const t=IS_MOBILE||!localStorage?Cookie:localStorage;return{getItem:e=>t.getItem(e),setItem(e,o){t.setItem(e,o)}}}();
class EventManager{eventType;eventCallback;constructor(e,t){this.eventType=e,this.eventCallback=t}addEventListener(e){e.addEventListener(this.eventType,this.eventCallback)}removeEventListener(e){e.removeEventListener(this.eventType,this.eventCallback)}}class Component{tagName;classNameWrapper;className;eventManager;_parent;_wrapper;_element;constructor(e,t,s,n){this._parent=e,this.tagName=t,this.className=s,this.classNameWrapper=n,this._wrapper=n?dom.getOrCreateElement(e,"div",n):void 0,this._element=dom.getOrCreateElement(this._wrapper||e,t,s)}updateElements(){this._wrapper=this.classNameWrapper?dom.getOrCreateElement(this._parent,"div",this.classNameWrapper):void 0,this._element=dom.getOrCreateElement(this._wrapper||this._parent,this.tagName,this.className),this._element.classList.toggle(this.className,!0)}_addEvent(e,t){this.eventManager=new EventManager(e,t)}_reset(){this.updateElements(),this._element.innerHTML="",this._element.classList.toggle(this.className,!0),this._visible(!0),this.eventManager?.addEventListener(this._element)}_remove(){this._element.innerHTML="",this.eventManager?.removeEventListener(this._element)}_visible(e){(this._wrapper||this._element).style.display=e?"":"none"}}class Breadcrumb extends Component{static CLASSNAME="breadcrumb";static CLASSNAME_WRAPPER="row";constructor(e){super(e,"ul",Breadcrumb.CLASSNAME,Breadcrumb.CLASSNAME_WRAPPER)}render(e,t,s){super._reset();const n=e.length;for(let s=0;s<n-1;s++)this.renderLink(e[s],t);"string"==typeof s?(this.renderLink(e[n-1],t),this.renderText(s)):n>0&&this.renderText(e[n-1].textContent)}renderLink(e,t){if(e){const s=dom.element("li",this._element);dom.element("a",s,e).addEventListener("click",t)}}renderText(e){e&&dom.element("span",dom.element("li",this._element),{textContent:e})}}class GoTop{static instance;element;disabled;constructor(){GoTop.instance=this,this.disabled=!1,this.element=dom.element("button",dom.getByTagName("main"),"go-top"),dom.svgUse(this.element,"#go_top","","30","30","img"),this.visible(!1),this.element.addEventListener("click",scrollTop),window.onscroll=scrollEvent}visible(e){this.element&&!this.disabled&&(this.element.style.display=e?"":"none")}}function scrollTop(){document.body.scrollTop=0,document.documentElement.scrollTop=0}function scrollEvent(){GoTop.instance.visible(document.body.scrollTop>20||document.documentElement.scrollTop>20)}class Tags extends Component{static DOM_TAGS_CLASSNAME="tags";static DOM_TAGS_ITEM_CLASSNAME="tag";static DOM_TAGS_HEADER_CLASSNAME="heading";constructor(e){super(e,"div",Tags.DOM_TAGS_CLASSNAME)}render(){super._reset();const e="Topics",t=[{href:"#",textContent:"this"},{href:"#",textContent:"is"},{href:"#",textContent:"under"},{href:"#",textContent:"construction"}];dom.text("span",this._element,e,Tags.DOM_TAGS_HEADER_CLASSNAME);for(const e of t)dom.element("a",dom.element("div",this._element,Tags.DOM_TAGS_ITEM_CLASSNAME),e)}}
class Menu{element;active=null;constructor(e){this.element=e,this.element.addEventListener("click",this)}click(e){this.setActive(this.active,!1),this.setActive(e.parentNode,!0)}setActive(e,t){e&&e.classList.toggle("active",t),this.active=t?e:null}navigateByIndex(e){const t=url.toQuery(e,null),i=this.element.querySelector(`a[href = "${t}"]`);i&&this.click(i)}handleEvent(e){"click"===e?.type&&this.onclick(e)}onclick(e){if(e.target instanceof Element){const t=e.target,i=router.urlSearchParams(t.getAttribute("href")||""),c=i?.page;c&&"0"!==c&&(e.preventDefault(),this.click(t),router.navigate(c,null))}}}
var Status,Prefix,Size,Type,SVG_LIBRARY;!function(t){t.info="info",t.error="error",t.success="success"}(Status||(Status={})),function(t){t.info="Info: ",t.error="Error: ",t.success="Success: "}(Prefix||(Prefix={})),function(t){t[t.small=20]="small",t[t.normal=22]="normal",t[t.large=24]="large"}(Size||(Size={})),function(t){t.msg="msg",t.alert="alert"}(Type||(Type={})),function(t){t.info="info",t.success="success",t.error="error",t.info_fill="info-fill",t.success_fill="success-fill",t.error_fill="error_fill",t.edit="edit",t.plus="plus",t.close_button="close_button"}(SVG_LIBRARY||(SVG_LIBRARY={}));const SVG_OPTIONS={width:Size.normal,height:Size.normal,byStatus:{info:{id:"info"},success:{id:"success"},error:{id:"error"}}},SVG_OPTIONS_FILL={width:Size.normal,height:Size.normal,byStatus:{info:{id:"info_fill"},success:{id:"success_fill"},error:{id:"error_fill"}}},OPTIONS={box:{className:"notify-box"},msg:{className:"msg-box",classNameItem:"item",classNameTitle:"msg-title",capacity:0,timer:0},alert:{className:"alert-box",classNameItem:"item",capacity:2,timer:1e4,ticker:1,close:1},button:{capacity:1,button:{label:"clickMe",svg:SVG_OPTIONS}},svg:{svg:SVG_OPTIONS},svg_fill:{svg:SVG_OPTIONS_FILL}},Renders={SYMBOL:{callback:msg_symbol_prefix_text,options:OPTIONS.svg},TITLE:{callback:msg_title_text},TEXT:{callback:msg_text},BUTTON:{callback:msg_button,options:OPTIONS.button},ALERT:{callback:alert_text,options:OPTIONS.svg_fill}};class Notify{static storage={};renders;constructor(t){Notify.defaultInit(t),this.renders=Renders}addCustomMethod(t,e,s,o,n){Notify.storage[t]={parent:e};const i=Notify.getBox(t),a=new Msg(t,i,Type[s],o,n);return Notify.storage[t]={parent:e,instance:a},Notify.prototype[t]=(t,e,s)=>a.render(t,e,s),Notify.prototype[t]}with(t){return Notify.storage[t].instance}clear(){Object.values(Notify.storage).forEach((t=>t.instance.clear()))}msg(t,e,s){Notify.storage.msg.instance.render(t,e,s)}alert(t,e,s){Notify.storage.alert.instance.render(t,e,s)}btn(t,e,s,o){const n=objects.assign({},{button:{func:s}},o||{});Notify.storage.btn.instance.render(t,e,n)}static remove(t){"object"==typeof Notify.storage[t]&&(Notify.storage[t].instance.clear(),delete Notify.storage[t])}static getBox(t){const e=dom.get(Notify.storage[t].parent),s=OPTIONS.box.className;return e.getElementsByClassName(s)[0]||dom.element("div",e,s)}static defaultInit(t){let e=t.article,s=t.messages;s.classList.toggle(OPTIONS.box.className,!0);const o=new Msg("msg",s,Type.msg,Renders.SYMBOL);Notify.storage.msg={parent:e,instance:o},e=t.header.firstChild,s=t.notify1;const n=new Msg("alert",s,Type.alert,Renders.ALERT);Notify.storage.alert={parent:e,instance:n},e=e.nextSibling,s=t.notify2;const i=new Msg("btn",s,Type.msg,Renders.BUTTON);Notify.storage.btn={parent:e,instance:i}}}class Msg{storage;name;parent;callback;options;timeout;ticker;constructor(t,e,s,o,n){this.storage=[],this.name=t,this.parent=dom.get(e),this.callback=o.callback,this.options=objects.assign({},OPTIONS[s],o.options||{},n||{}),this.timeout=1}render(t,e,s){const o=objects.assign({},this.options,s||{});document.body.contains(this.parent)||(this.parent=Notify.getBox(this.name)),o.capacity>0&&this.storage.length>=o.capacity&&dom.remove(this.storage.shift()),o.timer>0&&(this.timeout=o.timer/1e3,this.ticker=this.ticker||setInterval(this.tick.bind(this),1e3));const n=this.callback(this.parent,t,e,o);if(o.close){dom.svgUse(dom.element("span",n,"btn-close"),"#close_button","","24","24","button").addEventListener("click",this.clear.bind(this))}this.storage.push(n)}tick(){--this.timeout<1&&this.clear(),this.options.ticker&&this.update()}update(){this.storage.forEach((t=>{(t.getElementsByClassName("ticker")[0]||dom.element("small",t,"ticker")).textContent=Number(this.timeout).toString()}))}clear(){const t=this.storage.length;for(let e=0;e<t;e++)dom.remove(this.storage.shift());"number"==typeof this.ticker&&(clearInterval(this.ticker),this.ticker=void 0)}}function msg_symbol_prefix_text(t,e,s,o){let{prefix:n}=o;const{classNameItem:i}=o;"string"!=typeof n&&(n=Prefix[e]);const a=msg_box(t,null,o);svg_element(a,e,o);const r=dom.element("small",a,i);return n&&dom.text("strong",r,n),"string"==typeof s&&dom.text("small",a,s,i),a}function msg_title_text(t,e,s,o){const{title:n,data:i}=s||{},a=msg_box(t,null,o),r=dom.element("div",a,o.classNameTitle);dom.node(n,dom.element("p",r));const c=dom.element("ul",r);for(const t of i)dom.node(t,dom.element("li",c));return a}function msg_text(t,e,s,o){const n=msg_box(t,null,o);return dom.text(o.tag||"strong",n,s,o.classNameItem),n}function msg_button(t,e,s,o){const{svg:n,tag:i,label:a,func:r}=o.button,c=msg_box(t,null,o);dom.setOptions(c,{role:"button"}),n&&svg_element(c,e,o);const l=dom.element("span",c,o.classNameItem);return dom.text(i||"strong",l,s||a),c.addEventListener("click",r),c}function alert_text(t,e,s,o){const n=msg_box(t,e,o);return svg_element(n,e,o),dom.text(o.tag||"span",n,s,o.classNameItem),n}const msg_box=(t,e,s)=>dom.element("div",t,s.className+(e?" "+e:""));function svg_element(t,e,s){const{hideSvg:o,classNameItem:n}=s;if(o)return;const i=objects.assign({},s.svg||s.button.svg);if(i.byStatus){const t=objects.assign({},i);objects.assign(i,i.byStatus[e],t)}const{id:a,width:r,height:c,color:l,className:m}=i;if(!a)return;const g=dom.svgUse(t,"#"+a,n,r,c);return m&&g.classList.toggle(m,!0),l&&(g.style.color=l),g}
const SUBJECT_ELEMENTS_LENGTH=4,subject={renderSubject:renderSubject};function renderSubject(t,e,n){const r=[];if(t.innerHTML="",e&&dom.text("h3",t,e),n){const t=[n.source,n.sourceUrl,n.author,n.authorUrl];for(const e of splitSubjectElements(t))r.push(e)}for(let e=0;e<r.length;e++){const[n,o,s,c]=r[e],u=dom.element("small",t);renderSubjectItem((e>0?"; ":"")+"source: ",n,o,u),renderSubjectItem(n?", author: ":"author: ",s,c,u)}}function renderSubjectItem(t,e,n,r){if(e||n)if(dom.node(t,r),n){const t="/"===n.at(0)?"_self":"_blank";dom.text("a",r,e||n,{href:n,target:t})}else e&&dom.text("span",r,e,"gray-light")}function splitSubjectElements(t){const e=t.map((t=>"string"==typeof t?t.split(";"):[""])),n=Math.max(...e.map((t=>t.length))),r=[];for(let t=0;t<n;t++){const n=new Array(SUBJECT_ELEMENTS_LENGTH);for(let r=0;r<SUBJECT_ELEMENTS_LENGTH;r++){const o=e[r];n[r]=o&&o[t]||""}r.push(n)}return r}
class Topics{element;static lastPage;constructor(){this.element=document.getElementsByTagName(DOM_TOPICS_PARENT_TAGNAME)[0]}async render(e){if(Topics.lastPage===e)return void this.focusLinkById();this.element.innerHTML=`<ul>${ASSETS_LOADER_PUFF}</ul>`;const t=Pages[e],n=APP_IS_STATIC?"":`?lang=${APP_LANG}`;try{const o=await data.getJson(`${t}${n}`,!0,!1);if(null===o)return;const s=o;this.element.innerHTML="";for(const t of s)this.renderTopic(this.element,e,t)}finally{Topics.lastPage=e}}renderTopic(e,t,n){const o=dom.element("ul",e);dom.text("h3",o,n.category);for(const e of n.links){const n=url.toQuery(t,e.id.toString());this.renderLink(o,n,e.text)}}renderLink(e,t,n){dom.text("a",dom.element("li",e),n,{href:t})}focusLinkById(e){const t="number"==typeof e?e.toString():e;for(const e of document.querySelectorAll("aside a")){const n=url.parseUrlSearchParams(e.getAttribute("href")||"");e.classList.toggle(CLASSNAME_FOCUS,n.id===t)}}}
const BAR_CLASSNAME="bar";var BAR_IDS;function getBarElements(){return{start:dom.getById(BAR_IDS.START),tabs:dom.getById(BAR_IDS.TABS),onPlay:{back:dom.getById(BAR_IDS.BACK),row:dom.getById(BAR_IDS.ROW),forward:dom.getById(BAR_IDS.FORWARD),shuffle:dom.getById(BAR_IDS.SHUFFLE)}}}!function(t){t.START="start",t.BACK="back",t.ROW="row",t.FORWARD="forward",t.SHUFFLE="shuffle",t.TABS="tabs",t.TAB="tab-"}(BAR_IDS||(BAR_IDS={}));class Bar extends Component{json;tabs;elements;activeTabs;constructor(t){super(t,"div","bar",void 0),this.tabs=[]}render(t){super._reset(),renderDom(this._element),this.elements=getBarElements(),this.json=t,this.tabs.length=0,this.activeTabs=this.json.state.tabs,this.onPlay(!1),this.elements.onPlay.row.disabled=!0;for(let t=0;t<this.activeTabs.length;t++)this.tabs.push(dom.element("button",this.elements.tabs,{id:BAR_IDS.TAB+t,textContent:this.json.labels[t]})),this.setActiveTab(t,!0)}start(){this.json.state.status=!0,this.setLabel(this.elements.start,"Stop"),this.setActive(this.elements.start,!0),this.onPlay(!0),this.resetTabs(!0)}stop(){this.json.state.status=!1,this.setLabel(this.elements.start,"Start"),this.setActive(this.elements.start,!1),this.onPlay(!1),this.resetTabs()}resetTabs(t){for(let e=0;e<this.activeTabs.length;e++){const s=!t||e!==this.json.state.card;this.setActiveTab(e,s)}}toggle(t){this.setActiveTab(t,!this.activeTabs[t])}setActiveTab(t,e){this.setActive(this.tabs[t],e),this.activeTabs[t]=e}shuffle(t){this.setActive(this.elements.onPlay.shuffle,t)}onPlay(t){Object.values(this.elements.onPlay).forEach((e=>e.style.display=t?"":"none"))}getRow(){return this.elements.onPlay.row.children[0].textContent}setRow(t){this.elements.onPlay.row.children[0].textContent=t||"0"}setActive(t,e=!0){t.classList.toggle("active",e)}setLabel(t,e){t.textContent=e}isActive(t){return this.activeTabs[t]}}function renderDom(t){t.innerHTML='<div class="buttons">\n        <button id="start">Start</button>\n        <button id="back">\n            <svg viewBox="0 0 32 32" width="15" height="15" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4">\n                <path d="M20 30 L8 16 20 2"/>\n            </svg>\n        </button>\n        <button id="row" disabled><small></small></button>\n        <button id="forward">\n            <svg viewBox="0 0 32 32" width="15" height="15" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="4">\n                <path d="M12 30 L24 16 12 2"/>\n            </svg>\n        </button>\n    </div>\n    <div class="toggles">\n        <button id="shuffle">\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" shape-rendering="geometricPrecision">\n                <path d="M16 3h5v5"/><path d="M4 20L21 3"/><path d="M21 16v5h-5"/><path d="M15 15l6 6"/><path d="M4 4l5 5"/>\n            </svg>\n        </button>\n    </div>\n    <div class="toggles">\n        <div class="toggles" id="tabs">\n        </div>\n        <button class="bar-menu" disabled>\n            <svg width="14" height="14" viewBox="0 0 24 24" width="15" height="15" alt="menu">\n                <path d="M24 6h-24v-4h24v4zm0 4h-24v4h24v-4zm0 8h-24v4h24v-4z" fill="currentColor"/>\n            </svg>\n        </button>\n    </div>'}
const CARDS_CLASSNAME="cards",CARDS_MASK_CHARACTER="_";class Cards extends Component{json;cards;active;words;status;constructor(t){super(t,"div","cards"),this.cards=[],this.words=[],this.active=-1}render(t){super._reset(),this.json=t,this.resetCards();for(let t=0;t<this.json.state.tabs.length;t++)this.createCard(this._element);this.setActive(this.json.state.card)}setActive(t){this.active>-1&&this.cards[this.active].classList.toggle("active",!1),this.json.state.card=t,this.active=t,this.cards[this.active].classList.toggle("active",!0)}populate(t){"number"==typeof t&&(this.json.state.row=t),this.words=this.json.data[this.json.state.row];for(let t=0;t<this.cards.length;t++)this.setContent(t,this.words?this.words[t]:"");this.update()}setContent(t,s){const e=this.cards[t]?.firstChild;e&&(e.textContent=s)}setStatus(t,s){this.cards[this.active].classList.toggle(t,s),this.cards[this.active].classList.toggle("active",!s),this.status=s?t:void 0}update(t){if(-1!==this.active&&this._element)if("number"==typeof t)this.updateIndex(t);else for(let t=0;t<this.cards.length;t++)this.updateIndex(t)}updateIndex(t){const s=this.json.state.tabs[t];t===this.active?(this.visibleContent(t,!0),s||"error"===this.status?this.setContent(t,this.words[t]):this.setContent(t,maskMiddleChars(this.words[t],"_"))):this.visibleContent(t,s)}createCard(t){const s=this.cards.length||0,e=dom.element("div",t);e.id="card"+(s+1),e.classList.add("card"),dom.element("h4",e),this.cards.push(e)}isValid(){return this.active>-1&&this.cards.length>this.active}visibleContent(t,s){const e=this.cards[t]?.firstChild;e&&(e.style.visibility=s?"":"hidden")}resetCards(){this.cards.length=0,this.json.state.row=0,this.active=-1,this.status=void 0}}
const MSG_INPUT={again:"Write this again.",placeholder:"Write this .."};var MSG_KEYBOARD;!function(t){t.OFF="keyboard: system",t.NORMAL="keyboard: virtual",t.KEYS="keyboard: virtual (keys)"}(MSG_KEYBOARD||(MSG_KEYBOARD={}));const UserInputStateKeys=["done","error","success","repeat","examples"];class UserInput extends Component{successCounter;errorsCounter;stats;input;controller;json;state={done:!1,error:!1,success:!1,repeat:!1,examples:!1};content="";word="";words=[];constructor(t){super(t,"div","input"),this.successCounter=SimpleCounter(),this.errorsCounter=SimpleCounter(),this.stats=new Stats,this.input=new TextInput(this)}render(t,e){super._reset(),this.json=t,dom.removeAll(this._element),this.stats.render(this._element),this.input.render(this._element),this.reset(),this.controller=e}read(){this.content=this.input.value,this.state.done=this.input.isDone(),this.state.done||(this.state.error=!this.contained(this.content,this.word),this.state.success=this.compare(this.content,this.word)),this.update(),this.state.done&&this.controller(this)}next(){this.clear(),this.words=this.json.data[this.json.state.row],this.word=this.words[this.json.state.card],this.input.setAssert(this.word),this.input.keyboard&&this.input.keyboard.renderKeys(this.word)}repeat(){this.clear(),this.state.repeat=!0,notify.msg("error",MSG_INPUT.again,{prefix:""}),this.input.textarea.placeholder=MSG_INPUT.again}reset(){this.clear(),this.successCounter.reset(),this.errorsCounter.reset(),this.stats.setStats(0,this.json.state.rows,0,0)}clear(){for(const t in this.state)this.state[t]=!1;this.input.clear(),notify.clear()}update(){if(this.state.done){if(this.state.error=!this.state.success,this.state.repeat)return;this.state.success?this.stats.change("success",this.successCounter.next()):this.stats.change("error",this.errorsCounter.next()),this.state.examples||Array.isArray(this.words.slice(-1)[0])}else this.input.setStatus(this.state.success?"success":this.state.error?"error":""),this.state.success&&(notify.clear(),notify.msg("info","",{prefix:"Done.",timer:3e3}))}visible(t){this._element.style.display=t?"":"none",t&&this.input.focus()}compare(t,e){return t===e}contained(t,e){return t===e.slice(0,t.length)}}class TextInput{static defaultOptions={form:{className:"form",spellcheck:"false",autocapitalize:"none",autocomplete:"off"},textarea:{placeholder:MSG_INPUT.placeholder}};controller;options;form;textarea;keyboard;status="";text="";constructor(t){this.controller=t,this.options=Object.assign({},TextInput.defaultOptions)}render(t,e={}){Object.assign(this.options,e),this.form=dom.element("form",t,this.options.form),this.textarea=dom.element("textarea",this.form,this.options.textarea),this.textarea.addEventListener("input",this),this.keyboard=new MyKeyboard(this).render(t,this.textarea),this.clear()}handleEvent(){this.assert()||(this.setStatus(""),this.controller.read())}get value(){return this.textarea.value||""}setStatus(t){this.status!==t&&(this.status=t||"",this.textarea.className=this.status+(APP_KEYBOARD.mode===KEYBOARD_MODE.OFF?"":" active"))}clear(){this.status="",this.textarea.value="",this.textarea.placeholder=this.options.textarea.placeholder}focus(){APP_KEYBOARD.mode===KEYBOARD_MODE.OFF&&this.textarea.focus()}isDone(){return["\n","\r"].includes(this.value.slice(-1))}setAssert(t){this.text=t}assert(){return this.text?(this.text=this.value.length<this.text.length?this.text:"",this.text&&!this.status&&this.text.startsWith(this.value)):null}}const KEYBOARDS={german:{small:["q","w","e","r","t","z","u","i","o","p","ü","ß","<--","a","s","d","f","g","h","j","k","l","ö","ä","#","Enter","_^","y","x","c","v","b","n","m",",",".","-","!","?"],big:["Q","W","E","R","T","Z","U","I","O","P","Ü","~","<--","A","S","D","F","G","H","J","K","L","Ö","Ä","'","Enter","_^","Y","X","C","V","B","N","M",";",":","_","!","?"]}};var KEYBOARD_MODE;!function(t){t[t.OFF=1]="OFF",t[t.NORMAL=2]="NORMAL",t[t.KEYS=4]="KEYS"}(KEYBOARD_MODE||(KEYBOARD_MODE={}));class MyKeyboard{static defaultOptions={keys:KEYBOARDS.german,className:"keyboard",classNameItem:"item",classNameLong:"item-long",classNameOther:"other",buttons:{Enter:"\n","<--":"del",__:" ","_^":"shift"}};static instance;options;controller;textarea;modeButton;keyboard;isBig=!1;constructor(t){MyKeyboard.instance=this,this.controller=t,this.options=Object.assign({},MyKeyboard.defaultOptions)}render(t,e,s){return Object.assign(this.options,s),this.textarea=e||this.textarea,this.modeButton=dom.element("span",t,{id:"keyboard",role:"button",className:"right"}),this.modeButton.addEventListener("click",this.changeMode),this.keyboard=dom.element("div",t,this.options.className),this.keyboard.addEventListener("click",this),this.setMode(APP_KEYBOARD.mode),this}renderKeyboard(t){if(APP_KEYBOARD.mode!==KEYBOARD_MODE.NORMAL)return;this.clear();let e,s=0;(t?this.options.keys.big:this.options.keys.small).forEach((t=>{0!==s&&s%13!=0||(e=dom.element("div",this.keyboard)),dom.element("button",e,{index:s,textContent:t,value:1===t.length?t:this.options.buttons[t],type:"button",role:"button",className:this.options.classNameItem}),s++})),e=dom.element("div",this.keyboard,this.options.classNameOther),dom.element("button",e,{textContent:" ",value:" ",type:"button",role:"button",className:this.options.classNameItem})}renderKeys(t){if(APP_KEYBOARD.mode!==KEYBOARD_MODE.KEYS)return;this.clear();const e=dom.element("div",this.keyboard),s=this.options.keys,i=s.small.length,r={};for(const e of t.split("")){let t=s.small.indexOf(e);t=t>-1?t:s.big.indexOf(e),t=t>-1?t:i,r[e]=t}const a=APP_KEYBOARD.size-Object.keys(r).length;for(let t=0;t<a;){const e=numbers.getRandomInt(0,i),a=s.small[e];r[a]||(r[a]=e,t++)}r["<--"]=i+2,r.Enter=i+3;Object.entries(r).sort(((t,e)=>t[1]-e[1])).map((t=>t[0])).forEach((t=>{dom.element("button",e,{textContent:t,value:1===t.length?t:this.options.buttons[t],type:"button",role:"button",className:this.options.classNameItem})}))}handleEvent(t){const e=t.target;if(t&&e.value){const t=e.value;if(t.length>2){if("del"!==t)return this.isBig=!this.isBig,void this.renderKeyboard(this.isBig);this.textarea.value=this.textarea.value.slice(0,-1)}else this.textarea.value+=t;this.controller.handleEvent()}}setMode(t){const e=MyKeyboard.instance.modeButton;APP_KEYBOARD.mode=t,MyKeyboard.instance.textarea.classList.toggle("active",t!==KEYBOARD_MODE.OFF),t===KEYBOARD_MODE.OFF?(MyKeyboard.instance.clear(),e.textContent=MSG_KEYBOARD.OFF):t===KEYBOARD_MODE.NORMAL?(MyKeyboard.instance.renderKeyboard(!0),e.textContent=MSG_KEYBOARD.NORMAL):t===KEYBOARD_MODE.KEYS&&(MyKeyboard.instance.renderKeys(MyKeyboard.instance.controller.text),e.textContent=MSG_KEYBOARD.KEYS)}changeMode(){const t=APP_KEYBOARD.mode;MyKeyboard.instance.setMode(t===KEYBOARD_MODE.OFF?KEYBOARD_MODE.NORMAL:t===KEYBOARD_MODE.NORMAL?KEYBOARD_MODE.KEYS:KEYBOARD_MODE.OFF)}clear(){this.keyboard.innerHTML=""}}
class List extends Component{static CLASSNAME="lists";static CLASSNAME_NUMBERING="numbering";table;data=[];cols=0;options;isEditable=!1;constructor(t){super(t,"table",List.CLASSNAME)}async render(t,e){super._reset(),this.table=this._element,this.data=t,this.cols=t[0]?.length||0,this.options=e,this.options?.contenteditable?(this.isEditable=!0,this.cols++,dom.setOptions(this.table,{spellcheck:"false",autocapitalize:"none",autocomplete:"off"}),this.table.classList.toggle(List.CLASSNAME_NUMBERING,!0)):(this.table.classList.toggle(List.CLASSNAME_NUMBERING,!1),this.isEditable=!1),List.renderRows(this.table,this.cols,this.data,this.isEditable,this.options)}updateColumnView(t,e){if(t)List.setColumnView(this.table,t,e[t]);else for(let t=0;t<this.cols;t++)List.setColumnView(this.table,t,e[t])}isValidRow(t,e){return Number.isInteger(t)&&t>-1&&t<e}isFilled(t){for(let e=0;e<t.length;e++){const s=t[e];if(strings.isBlank(s.textContent||""))return!1}return!0}read(){const t=this.table.rows.length,e=this.table.rows[0].cells.length,s=[],i=[];for(let l=0;l<t;l++){const t=Array(e),o=this.table.rows[l].cells;if(this.isFilled(o)){for(let s=0;s<e;s++)t[s]=o[s].textContent||"";s.some((e=>List.equals(e,t,this.isEditable)))||s.push(t)}else i.push(this.table.rows[l])}return i.forEach((t=>dom.remove(t))),s}appendRow(){List.renderRow(this.table,this.cols,this.isEditable?[(this.table.rows.length+1).toString()]:[],this.options)}static equals(t,e,s){const i=s?1:0,l=e.slice(i);return t.slice(i).every(((t,e)=>t===l[e]))}static renderRow(t,e,s,i){const l=dom.element("tr",t);for(let t=0;t<e;t++)dom.text("th",l,s[t]||"",i)}static renderRows(t,e,s,i,l){let o=1;for(const n of s){const s=i?[(o++).toString(),n].flat():n;List.renderRow(t,e,s,l)}}static setColumnView(t,e,s){const i=t.getElementsByTagName("tr");for(let t=0;t<i.length;t++){i[t].cells[e].style.display=s?"":"none"}}coloredTable(t){super._reset();for(const e in t){const s=t[e],i=dom.element("tr",this.table);s.name&&(dom.text("th",i,s.name),s.colors.forEach((t=>{dom.text("th",i,t).style.backgroundColor=t})))}}}
const StatsKeys=["error","success","done","rows"];class Stats{static defaultOptions={stats:{className:"stats right"},award:{src:"./assets/images/award.svg",alt:"award",width:"18",height:"18"},counts:{className:"counts left"}};elements;constructor(){}render(t,e){const s=e||Stats.defaultOptions,n=dom.element("div",t),o={},m=dom.element("div",n,s.stats);o.error=dom.element("small",m),o.success=dom.element("small",m),dom.element("img",m,s.award);const l=dom.element("div",n,s.counts);o.done=dom.element("small",l),dom.text("span",l,"|"),o.rows=dom.element("small",l),this.elements=o,this.setStats(0,0,0,0)}getStats(){return{done:this.elements?.done.textContent||"0",rows:this.elements?.rows.textContent||"0",error:this.elements?.error.textContent||"0",success:this.elements?.success.textContent||"0"}}setStats(t,e,s,n){this.elements&&(this.elements.done.textContent=t.toString(),this.elements.rows.textContent=e.toString(),this.elements.error.textContent=s.toString(),this.elements.success.textContent=n.toString())}change(t,e){this.elements&&(this.elements[t].textContent=e.toString())}plus(t){this.elements&&(this.elements[t].textContent=(Number.parseInt(this.elements[t].textContent||"0")+1).toString())}}
class Country{wrapper;element;info;textElement;active;meta;constructor(e){this.wrapper=dom.element("div",e,"row maps"),this.element=dom.element("div",this.wrapper),this.info=dom.element("div",this.wrapper,"column"),this.element.addEventListener("click",this)}async render(e){this.reset(),this.element.innerHTML=e.svg,this.meta=e.meta}renderInfo(e){this.info.innerHTML="",dom.element("div",this.info).innerHTML=e.flag||e.coat_of_arms||"",dom.text("h3",this.info,`${e.state} (${e.ISO3166_2})`),dom.element("div",this.info).innerHTML=`<strong>Fläche</strong> : ${e.area} km<sup>2</sup>`,dom.element("div",this.info).innerHTML=`<strong>Einwohner (2018)</strong> : ${numberWithCommas(e.population)} Mio.`,this.textElement=this.textElement||document.getElementById("map-text"),this.textElement.textContent=e.state}reset(){this.textElement=null,this.element.innerHTML="",this.info.innerHTML=""}setActive(e){e&&this.active&&this.active.classList.toggle("active",void 0),e&&e.classList.toggle("active",!0),this.active=e}navigateByIndex(e){this.setActive(document.getElementById(e))}handleEvent(e){"click"===e.type&&this.onClick(e.target)}onClick(e){if("path"===e.tagName){this.setActive(e);const t=this.meta?this.meta[Number.parseInt(e.id)]:null;t&&this.renderInfo(t)}}}function numberWithCommas(e){return e>=1e3?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"0,"+e}
const QUIZ_QUESTIONS_CLASSNAME="questions",QUIZ_RESULTS_CLASSNAME="results",QUIZ_CARD_CLASSNAME="card",QUIZ_VALIDATE_CLASSNAME="validate",QUIZ_BNT_CLEAR_CLASSNAME="clear",QUIZ_BNT_VALIDATE="Validate",QUIZ_BNT_CLEAR="Clear",QUIZ_BNT_VIEW="view";class Quiz{static instance;parent;element;bnt;questions=[];validator;json;isValidated=!1;constructor(e){this.parent=e,Quiz.instance=this}async render(e,t){if(!e)return;this.json=e,this.questions=e.questions,this.isValidated=!1,this.validator=t,this.parent.innerHTML=DEBUG_CONTENT;const s=this.renderResult(this.parent,"results","card")?.firstChild?.lastChild;s instanceof HTMLElement&&(s.textContent="view",s.addEventListener("click",t)),this.element=dom.element("ol",this.parent,"questions");for(let e=0;e<this.questions.length;e++)this.renderQuestion(this.element,this.questions[e],e);this.bnt=dom.text("button",this.parent,"Validate","validate"),this.bnt.addEventListener("click",t)}renderResult(e,t,s){const n=dom.element("div",e,t),i=dom.element("div",n,s);return dom.element("span",i),dom.element("div",i,{style:"cursor: pointer;"}),n}renderQuestion(e,t,s){const n=dom.element("div",e,"question");dom.text("span",dom.element("li",n),t.text);const i=dom.element("div",n);for(let e=0;e<t.answers.length;e++)this.renderAnswer(i,t.answers[e],e,s)}renderAnswer(e,t,s,n){const i=dom.element("label",e,"answer");dom.element("input",i,{name:`question${n}`,type:"checkbox",value:s}),dom.text("span",i,t.text)}reset(){this.render(this.json,this.validator)}validate(e){Quiz.instance.bnt.textContent="Clear",Quiz.instance.bnt.classList.toggle("clear",!0);const t=this.validateQuestions(e),s=t.length,n=t.filter(Boolean).length;Array.from(document.getElementsByClassName("questions")[0].children).map(((e,s)=>{t[s]&&(e.innerHTML=`<li>${QUIZ_CORRECT_QUESTION_SVG}</li>`)}));const i=document.getElementsByClassName("results")[0]?.firstChild;return i&&(i.firstChild.textContent=`${n}/${s}`,i.lastChild.textContent="Clear"),this.isValidated=!0,{correct:n,from:s}}validateQuestions(e){const t=document.getElementsByClassName("questions")[0],s=Array.from(t.children);let n=0;return s.map((t=>this.validateQuestion(t,e[n++])))}validateQuestion(e,t){const s=e.getElementsByTagName("input");let n,i,l=!1,r=!1;for(let e=0;e<s.length;e++)n=s[e],i=n.checked,l=l||i,Flags.isTrue(t,Flags.toBits(e))?n.parentNode.classList.toggle("correct",!0):i&&(n.parentNode.classList.toggle("wrong",!0),r=!0);return!r&&l}getUserAnswers(){const e=document.getElementsByClassName("questions")[0],t=Array.from(e.children),s=Array(t.length);let n;for(let e=0;e<t.length;e++){const i=t[e].getElementsByTagName("input");n=0;for(let e=0;e<i.length;e++)i[e].checked&&(n=Flags.set(n,Flags.toBits(e)));s[e]=n}return s}}
const DOM_ELEMENTS=["pageheader","menu","topics","article","header","control","content","messages","bottom","cdate","breadcrumb","subject","notify1","notify2"],PAGE_ELEMENTS=getDomElements();class Page{renders=[renderDefault,renderHome];isActive=!1;elements;constructor(){this.elements=PAGE_ELEMENTS}async renderPage(e,t){this.reset(),e.route.init&&e.route.init();const n=e.route;if(document.title=e.route.title,await topics.render(e.page===Pages.home?Pages.cards:e.page),breadcrumb.render(e.getLinks(),e.renderEvent),subject.renderSubject(PAGE_ELEMENTS.subject,n.subject),PAGE_ELEMENTS.content.innerHTML="",t){const e=n.render;if("number"==typeof e&&e>=0&&e<this.renders.length){const t=this.renders[e];await t(PAGE_ELEMENTS.content)}}}renderExercise(e,t){this.reset();const{id:n,name:E,category:r}=t;this.isActive=!1,topics.focusLinkById(n),breadcrumb.render(e.getLinks(),e.renderEvent,r),subject.renderSubject(PAGE_ELEMENTS.subject,E,t),PAGE_ELEMENTS.content.innerHTML=""}play(e){notify.clear(),PAGE_ELEMENTS.pageheader.style.display=e?"none":"",PAGE_ELEMENTS.menu.style.display=e?"none":"",PAGE_ELEMENTS.topics.style.display=e?"none":"",e&&(PAGE_ELEMENTS.content.style.display=""),this.isActive=e}reset(){PAGE_ELEMENTS.pageheader.removeAttribute("style"),PAGE_ELEMENTS.menu.removeAttribute("style"),PAGE_ELEMENTS.topics.removeAttribute("style"),PAGE_ELEMENTS.article.removeAttribute("style"),PAGE_ELEMENTS.control.innerHTML="",PAGE_ELEMENTS.content.innerHTML="",PAGE_ELEMENTS.content.removeAttribute("style"),PAGE_ELEMENTS.messages.innerHTML="",PAGE_ELEMENTS.bottom.innerHTML="",PAGE_ELEMENTS.notify2.innerHTML="",this.isActive=!1}}function getDomElements(){const e={};e.pageheader=dom.getByTagName(DOM_PAGEHEADER_TAGNAME),e.menu=dom.getByClassName(DOM_MENU_CLASSNAME),e.topics=dom.getByTagName(DOM_TOPICS_PARENT_TAGNAME),e.article=dom.getByTagName(DOM_ARTICLE_TAGNAME),e.header=dom.getById(DOM_HEADER_ID),e.control=dom.getById(DOM_CONTROL_ID),e.content=dom.getById(DOM_CONTENT_ID),e.messages=dom.getById(DOM_MESSAGES_ID),e.bottom=dom.getById(DOM_BOTTOM_ID),e.cdate=dom.getById(DOM_CDATE_ID),e.cdate.textContent=`${(new Date).getFullYear()}`;const t=dom.element("div",e.header,"row"),n=dom.element("div",e.header,"row");return dom.element("hr",e.header),e.breadcrumb=dom.element(DOM_BREADCRUMB_TAGNAME,t,DOM_BREADCRUMB_CLASSNAME),e.subject=dom.element("div",n,DOM_SUBJECT_CLASSNAME),e.notify1=dom.element("div",t,DOM_NOTIFY_CLASSNAME),e.notify2=dom.element("div",n,DOM_NOTIFY_CLASSNAME),e}async function renderHome(e){await debugContent(e)}async function renderDefault(e){await debugContent(e)}async function debugContent(e){e.innerHTML=DEBUG_CONTENT}
var URL_SEARCH_PARAMS;!function(t){t.page="page",t.id="id",t.username="username"}(URL_SEARCH_PARAMS||(URL_SEARCH_PARAMS={}));class State{static saved={};static isNewState=!1;static page=0;static id=null;static isNewPage=!1;static isNewId=!1;static isBlank=!1;constructor(){}static save(t,e){const a=State.getPage(t),s=State.getId(e);State.isNewPage=State.saved.page!==a,State.isNewId=State.saved.id!==s,State.isBlank=State.isNewId&&null===s,State.page=a,State.id=s,State.saved={page:a,id:s},State.isNewState=State.isNewPage||State.isNewId}static push(t){if(State.isNewState){const e=url.toQuery(State.saved.page||0,State.saved.id||null);window.history.pushState(Object.assign({},State.saved),t||"",e),State.isNewState=!1}}static getPage(t){return Number.isInteger(t)&&t>0?t:0}static getId(t){return t&&strings.isValid(t)?strings.clear(t):null}}class Router{static instance;page;routes;route;constructor(){Router.instance=this,this.page=Pages.home,this.routes=routes,this.route=this.routes[this.page]}static isValid(t){return Number.isInteger(t)&&t>-1&&t<routes.length}static getIndex(t){const e="string"==typeof t?parseInt(t):t;return Router.isValid(e)?e:Pages.home}setPage(t){return this.page=Router.getIndex(t),this.route=this.routes[this.page],this.page}urlSearchParams(t){const e="string"==typeof t?url.parseUrlSearchParams(t):url.getLocationSearchParams(),a={};for(const t of Object.values(URL_SEARCH_PARAMS))Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t]||null);return 0===Object.keys(a).length?void 0:a}getLinks(){const t=[];return this.page>0&&(t.push({href:url.toQuery(0,null),textContent:this.routes[0].subject}),t.push({href:url.toQuery(this.page,null),textContent:this.route.subject})),t}async navigate(t,e,a){if(a){const t=("string"==typeof a?this.urlSearchParams(a):a)||{};return t.username&&(USER.username=t.username),void await this.navigate(t.page||null,t.id||null)}let s="string"==typeof t||"number"==typeof t?Router.getIndex(t):this.page;s=e&&0===s?Pages.cards:s,State.save(s,e),State.push(this.route.title),(State.isNewPage||State.isNewId)&&await Router.update()}static async update(t){const e=Router.instance;if(t&&t.state){const e=Router.getIndex(t.state.page),a=t.state.id;State.save(e,a)}State.isNewPage&&e.setPage(State.page);const a=State.id&&State.isNewId;navigation.top.navigateByIndex(e.page||1),(State.isNewPage||State.isBlank)&&await page.renderPage(Router.instance,!a),a&&await exerciseService.render(State.id)}async renderEvent(t){if(t.target instanceof HTMLElement&&t.target.hasAttribute("href")){t.preventDefault();const e=t.target.getAttribute("href")||"";await Router.instance.navigate(null,null,e)}}}window.onpopstate=async function(t){await Router.update(t)};
var Pages,RenderIndex;!function(e){e[e.home=0]="home",e[e.cards=1]="cards",e[e.quizzes=2]="quizzes",e[e.maps=3]="maps",e[e.login=4]="login",e[e.register=5]="register"}(Pages||(Pages={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.HOME=1]="HOME"}(RenderIndex||(RenderIndex={}));const routes=[{path:"/",name:"home",title:APP_TITLE,subject:"Home",render:RenderIndex.HOME},{path:"/cards",name:"cards",title:"Cards",subject:"Cards",render:RenderIndex.DEFAULT},{path:"/quizzes",name:"quizzes",title:"Quiz",subject:"Quiz",render:RenderIndex.DEFAULT},{path:"/maps",name:"maps",title:"Maps",subject:"Maps",render:RenderIndex.DEFAULT},{path:"/login",name:"login",title:"Login",subject:"Login"},{path:"/register",name:"register",title:"Register",subject:"Register"}];
const PATH_SERVICES="./services/",EXERCISE_SERVICES_BY_INDEX=[void 0,{fileName:"flashcards.js",adaptable:!0,controller:!0},{fileName:"quizzes.js"},{fileName:"maps.js"}];class ExerciseService{static instance;key="";constructor(){}async render(e){const t=EXERCISE_SERVICES_BY_INDEX[router.page||1],r=t.fileName;router.setPage(router.page||1);const s=await factory.importClassWithArgs("./services/",r);ExerciseService.instance=await factory.getInstanceWithArgs(s,elements.content),t.controller&&ExerciseService.instance.setController(this);const n=router.route.path+"/"+e,a=await data.getJson(n,!t.cashable,t.adaptable);if(!a){throw new Error("Unable to get resource with id: "+e)}const c=a,i=c.exercise;page.renderExercise(router,i),await ExerciseService.instance.render(c)}processResult(e){const{count:t,stack:r,success:s,errors:n,timer:a}=e,c=`${t} | ${r} (${s} successes, ${n} errors, ${a.label} time)`;notify.msg("success",c,{prefix:"Done!"})}controlBarEvent(e){if(e.target instanceof Element){const t=getButtonElement(e.target);ExerciseService.instance?.clickButton(t?.getAttribute("id"))}}}function getButtonElement(e){if(e instanceof Element)return"BUTTON"===e.tagName?e:"DIV"===e.tagName?void 0:getButtonElement(e.parentElement)}
const init = (async () => {
    const data = new Data();
    const router = new Router();
    const page = new Page();
    const elements = page.elements;
    const topics = new Topics();
    const notify = new Notify(elements);
    new GoTop();
    const navigation = {
        top: new Menu(elements.menu),
    };
    const exerciseService = new ExerciseService();
    const breadcrumb = await factory.getInstanceWithArgs(Breadcrumb, elements.header);
    elements.topics.addEventListener('click', router.renderEvent);
    factory.addProps('Bar', { eventType: 'click', event: exerciseService.controlBarEvent });
    return { data, router, page, elements, topics, breadcrumb, notify, navigation, exerciseService };
})();
const { data, router, page, elements, topics, breadcrumb, notify, navigation, exerciseService } = await init;
export {APP_IS_STATIC, APP_NAME, BAR_IDS, Bar, Cards, Country, List, Quiz, ScopeCounter, Tags, Timer, TimerOption, UserInput, data, elements, factory, localRepository, notify, page, removeHTML, router};